#!/usr/bin/env sh

set -e

echo "ğŸ‰ Hey there! Time to make sure your code is looking fresh! ğŸ‰"
echo ""

# Check Prettier formatting
echo "ğŸ¨ Let me check if your code is dressed to impress..."
if ! pnpm run check-format; then
    echo ""
    echo "ğŸ˜± Oops! Your code is looking a bit... chaotic? No worries!"
    echo "âœ¨ Let me give it a makeover real quick..."
    pnpm run format
    git add .
    echo ""
    echo "ğŸ’… Much better! Your code is now looking fabulous!"
    echo "ğŸ“ Updating your commit with the new look..."
    git commit --amend --no-edit
    echo "ğŸŠ All done! Your commit is now looking snazzy!"
    echo ""
fi

# Check ESLint
echo "ğŸ§¹ Now let's make sure there's no lint in your code (get it? lint? ğŸ˜)..."
if ! pnpm run lint; then
    echo ""
    echo "ğŸš« Nope nope nope! ESLint found some issues!"
    echo "ğŸ˜¤ Your code needs some TLC before it can join the party."
    echo "ğŸ”§ Fix those errors above, add your changes, and try again!"
    echo ""
    exit 1
fi
echo "âœ¨ Linting check passed! Your code is squeaky clean!"

# Check TypeScript types
echo "ğŸ”® Time to check if your types are playing nicely together..."
if ! pnpm run check-types; then
    echo ""
    echo "ğŸ’¥ TypeScript is having a meltdown!"
    echo "ğŸ¤¯ Your types are confused and need some guidance."
    echo "ğŸ› ï¸  Fix those type errors above and come back when you're ready!"
    echo ""
    exit 1
fi
echo "ğŸ¯ Type check passed! Everything is properly typed!"

echo ""
echo "ğŸŠğŸŠğŸŠ SUCCESS! ğŸŠğŸŠğŸŠ"
echo "ğŸš€ Your code is ready to fly! Go ahead and commit!"
echo ""
